<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>M7_HeatLock</name>
    <events>
        <variable constant="0" name="M7_HEATLOCK_NUMBEROFROOMS" sid="219805138335277" static="0" type="number">7</variable>
        <variable constant="1" name="M7_ALPHABET" sid="815444082714423" static="0" type="text">ABCDEFGHIJKLMNOPQRSTUVWXYZ</variable>
        <variable constant="0" name="M7_HeatLockTemperature" sid="176103752440200" static="0" type="number">18</variable>
        <variable constant="0" name="DEBUGPOSSIBLEROOMS" sid="253763295165694" static="0" type="text"></variable>
        <event-group description="" sid="221648568052963" title="M7 Heat Lock Updating Temperature">
            <sub-events>
                <event-group description="" sid="259876896402846" title="M7 Room Temperature Initialization">
                    <sub-events>
                        <event-block sid="748490071379055">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="660164024395221" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="101506629238562" type="System">
                                    <param id="0" name="Variable">M7_HEATLOCK_NUMBEROFROOMS</param>
                                    <param id="1" name="Value">M7_Room.Count</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group description="" sid="911608263032701" title="M7 Change By Object" />
                <event-group description="" sid="574697527148302" title="M7 Change By Door" />
                <event-group description="" sid="403950509424355" title="M7 Change By Self" />
            </sub-events>
        </event-group>
        <event-group description="" sid="477988417948673" title="M7 Heat Lock Person Behaviour">
            <sub-events>
                <event-group description="" sid="700672218353482" title="M7 Heat Lock Person Spawning">
                    <sub-events>
                        <variable constant="0" name="tempval" sid="485382954874502" static="0" type="number">0</variable>
                        <event-block sid="695204180281465">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="351587798377850" type="System" />
                                <condition id="-11" name="For Each" sid="803406688183622" type="System">
                                    <param id="0" name="Object">M7_Person</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="777932405434668" type="System">
                                    <param id="0" name="Variable">tempval</param>
                                    <param id="1" name="Value">floor(random(0, M7_HEATLOCK_NUMBEROFROOMS))</param>
                                </action>
                                <action id="-10" name="Set value" sid="170204680818069" type="M7_Person">
                                    <param id="0" name="Instance variable">CurrentRoom</param>
                                    <param id="1" name="Value">mid(M7_ALPHABET, tempval, 1)</param>
                                </action>
                                <action id="-10" name="Set value" sid="300700905452528" type="M7_Person">
                                    <param id="0" name="Instance variable">PreviousRoom</param>
                                    <param id="1" name="Value">M7_Person.CurrentRoom</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="480297912395507">
                                    <conditions>
                                        <condition id="-11" name="For Each" sid="925867933681916" type="System">
                                            <param id="0" name="Object">M7_Room</param>
                                        </condition>
                                        <condition id="-7" name="Compare instance variable" sid="706338732861519" type="M7_Person">
                                            <param id="0" name="Instance variable">CurrentRoom</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">M7_Room.ID</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-3" name="Set position" sid="377029277269619" type="M7_Person">
                                            <param id="0" name="X">M7_Room.X</param>
                                            <param id="1" name="Y">M7_Room.Y</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group description="" sid="444692670807075" title="M7 Heat Lock Person Movement">
                    <sub-events>
                        <variable constant="0" name="M7_COLLISION_MARGIN" sid="724697748366516" static="0" type="number">0</variable>
                        <variable constant="1" name="M7_WAITTIMEMIN" sid="613549810525179" static="0" type="number">1</variable>
                        <variable constant="1" name="M7_WAITTIMEMAX" sid="426087903147023" static="0" type="number">2</variable>
                        <event-block sid="336021872179128">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="120223814381876" type="M7_Person">
                                    <param id="0" name="Instance variable">State</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;waiting&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="590649684976288">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="811467062452882" type="M7_Person">
                                            <param id="0" name="Instance variable">WaitingTimer</param>
                                            <param id="1" name="Comparison">4</param>
                                            <param id="2" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="397469028218230" type="M7_Person">
                                            <param id="0" name="Instance variable">WaitingTimer</param>
                                            <param id="1" name="Value">M7_Person.WaitingTimer - dt</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>Determine Next Action</comment>
                                <event-block sid="374070843056974">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="392516550210689" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="181801980070952" type="Function">
                                            <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                            <param id="1" name="Parameter {n}">M7_Person.UID</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="208338797312512">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="860086032869105" type="M7_Person">
                                    <param id="0" name="Instance variable">State</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;moving&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment>Reached Destination</comment>
                                <event-block sid="354109188775633">
                                    <conditions>
                                        <condition id="1" name="Is overlapping another object" sid="916276856012041" type="M7_Person">
                                            <param id="0" name="Object">M7_Room</param>
                                        </condition>
                                        <condition id="-7" name="Compare instance variable" sid="392328718561059" type="M7_Room">
                                            <param id="0" name="Instance variable">ID</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">M7_Person.CurrentRoom</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="962171767147607" type="Function">
                                            <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                            <param id="1" name="Parameter {n}">M7_Person.UID</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>Randomly Determine Next Action</comment>
                        <event-block sid="186799551660957">
                            <conditions>
                                <condition id="0" name="On function" sid="862728617815642" type="Function">
                                    <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                </condition>
                                <condition id="-14" name="Pick by unique ID" sid="226069610137845" type="M7_Person">
                                    <param id="0" name="Unique ID">Function.Param(0)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <variable constant="0" name="M7_PathfindingResult" sid="159745861010634" static="0" type="text"></variable>
                                <comment>Choose State &quot;wait&quot;</comment>
                                <event-block sid="883936257607422">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="578717455060691" type="System">
                                            <param id="0" name="First value">choose(0,1)</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="271121073450955" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Value">&quot;waiting&quot;</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="480034802995934" type="M7_Person">
                                            <param id="0" name="Instance variable">WaitingTimer</param>
                                            <param id="1" name="Value">floor(random(M7_WAITTIMEMIN, M7_WAITTIMEMAX))</param>
                                        </action>
                                        <action behavior="CustomMovement" id="2" name="Set speed" sid="517012467587597" type="M7_Person">
                                            <param id="0" name="Which">0</param>
                                            <param id="1" name="Speed">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>Choose State &quot;moving&quot;</comment>
                                <event-block sid="763834153155574">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="508506810105473" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="290334859214283" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Value">&quot;moving&quot;</param>
                                        </action>
                                        <action id="0" name="Call function" sid="890305022044891" type="Function">
                                            <param id="0" name="Name">&quot;M7 Generate Path&quot;</param>
                                            <param id="1" name="Parameter {n}">M7_Person.CurrentRoom{###}M7_Person.PreviousRoom</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="338739071057528" type="System">
                                            <param id="0" name="Variable">M7_PathfindingResult</param>
                                            <param id="1" name="Value">Function.ReturnValue</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="816077364387251" type="M7_Person">
                                            <param id="0" name="Instance variable">PreviousRoom</param>
                                            <param id="1" name="Value">M7_Person.CurrentRoom</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <comment>If Dead End</comment>
                                        <event-block sid="442489189099247">
                                            <conditions>
                                                <condition id="-14" name="Compare variable" sid="501842653188751" type="System">
                                                    <param id="0" name="Variable">M7_PathfindingResult</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">&quot;&quot;</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="150865044490297" type="M7_Person">
                                                    <param id="0" name="Instance variable">State</param>
                                                    <param id="1" name="Value">&quot;waiting&quot;</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="680944514495134" type="M7_Person">
                                                    <param id="0" name="Instance variable">WaitingTimer</param>
                                                    <param id="1" name="Value">floor(random(M7_WAITTIMEMIN, M7_WAITTIMEMAX))</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="189113331255401" type="M7_Person">
                                                    <param id="0" name="Which">0</param>
                                                    <param id="1" name="Speed">0</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block sid="564717244208916">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="940057136256202" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="819282974575447" type="M7_Person">
                                                    <param id="0" name="Instance variable">CurrentRoom</param>
                                                    <param id="1" name="Value">M7_PathfindingResult</param>
                                                </action>
                                                <action id="0" name="Call function" sid="574174858528248" type="Function">
                                                    <param id="0" name="Name">&quot;M7 Get Angle Of Room&quot;</param>
                                                    <param id="1" name="Parameter {n}">M7_Person.X{###}M7_Person.Y{###}M7_Person.CurrentRoom{###}M7_Person.PreviousRoom</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="462105046730464" type="M7_Person">
                                                    <param id="0" name="Which">1</param>
                                                    <param id="1" name="Speed">M7_Person.Speed * cos(Function.ReturnValue)</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="163768502310696" type="M7_Person">
                                                    <param id="0" name="Which">2</param>
                                                    <param id="1" name="Speed">M7_Person.Speed * sin(Function.ReturnValue)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group description="" sid="917615544399952" title="M7 Heat Lock Person Pathfinding">
                    <sub-events>
                        <variable constant="0" name="M7_PreviousRoom" sid="779199900776871" static="0" type="text"></variable>
                        <variable constant="0" name="M7_Destination" sid="924721281698815" static="0" type="text"></variable>
                        <variable constant="0" name="M7_CurrentRoom" sid="270822681677396" static="0" type="text"></variable>
                        <event-block sid="829543956718511">
                            <conditions>
                                <condition id="0" name="On function" sid="284524971819460" type="Function">
                                    <param id="0" name="Name">&quot;M7 Generate Path&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="269290658189094" type="System">
                                    <param id="0" name="Variable">M7_CurrentRoom</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="499444474329027" type="System">
                                    <param id="0" name="Variable">M7_PreviousRoom</param>
                                    <param id="1" name="Value">Function.Param(1)</param>
                                </action>
                                <action id="-9" name="Set value" sid="935744398487189" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">Function.Call(&quot;M7 Get Adjacent Rooms&quot;, M7_CurrentRoom)</param>
                                </action>
                                <action id="-9" name="Set value" sid="541964821514419" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">replace(M7_Destination, M7_PreviousRoom, &quot;&quot;)</param>
                                </action>
                                <action id="-9" name="Set value" sid="960757969643621" type="System">
                                    <param id="0" name="Variable">DEBUGPOSSIBLEROOMS</param>
                                    <param id="1" name="Value">M7_Destination</param>
                                </action>
                                <action id="-9" name="Set value" sid="546377288087668" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">mid(M7_Destination, floor(random(0, len(M7_Destination))),1)</param>
                                </action>
                                <action id="1" name="Set return value" sid="885772685597118" type="Function">
                                    <param id="0" name="Value">M7_Destination</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
        <event-group description="" sid="615369672928270" title="M7 Heat Lock Object Interactions">
            <sub-events>
                <event-group description="" sid="545667328686850" title="M7 Heat Lock Door">
                    <sub-events>
                        <event-block sid="847028597215671">
                            <conditions>
                                <condition id="17" name="On tap object" sid="948535004466842" type="Touch">
                                    <param id="0" name="Object">M7_Door</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-10" name="Set value" sid="506243875820990" type="M7_Door">
                                    <param id="0" name="Instance variable">Open</param>
                                    <param id="1" name="Value">M7_Door.Open = 0 ? 1 : 0</param>
                                </action>
                                <action id="4" name="Set animation" sid="954334525393956" type="M7_Door">
                                    <param id="0" name="Animation">M7_Door.Open = 0 ? &quot;Closed&quot; : &quot;Open&quot;</param>
                                    <param id="1" name="From">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
        <event-group description="" sid="662058481164618" title="M7 Heat Lock Scoring" />
        <event-group description="" sid="232970218801745" title="M7 Heat Lock Helper Functions">
            <sub-events>
                <event-block sid="937886539861470">
                    <conditions>
                        <condition id="0" name="On function" sid="930748571723830" type="Function">
                            <param id="0" name="Name">&quot;M7 Get Angle Of Room&quot;</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="185313251191878" type="System">
                            <param id="0" name="Object">M7_Room</param>
                        </condition>
                        <condition id="-7" name="Compare instance variable" sid="434464782366107" type="M7_Room">
                            <param id="0" name="Instance variable">ID</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">Function.Param(2)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Set return value" sid="356251581363440" type="Function">
                            <param id="0" name="Value">angle(Function.Param(0), Function.Param(1), M7_Room.X, M7_Room.Y)</param>
                        </action>
                        <action id="-24" name="Stop loop" sid="989660388283136" type="System" />
                    </actions>
                </event-block>
                <event-block sid="949421505739302">
                    <conditions>
                        <condition id="0" name="On function" sid="420088847365256" type="Function">
                            <param id="0" name="Name">&quot;M7 Get Adjacent Rooms&quot;</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="496249197418066" type="System">
                            <param id="0" name="Object">M7_Room</param>
                        </condition>
                        <condition id="-7" name="Compare instance variable" sid="599024979976557" type="M7_Room">
                            <param id="0" name="Instance variable">ID</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">Function.Param(0)</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="1" name="Set return value" sid="711928380910736" type="Function">
                            <param id="0" name="Value">M7_Room.Connection0 &amp; M7_Room.Connection1 &amp; M7_Room.Connection2</param>
                        </action>
                        <action id="-24" name="Stop loop" sid="866875629386993" type="System" />
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
