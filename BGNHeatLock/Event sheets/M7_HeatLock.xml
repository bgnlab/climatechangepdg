<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>M7_HeatLock</name>
    <events>
        <variable constant="0" name="M7_NUMBEROFROOMS" sid="219805138335277" static="0" type="number">7</variable>
        <variable constant="0" name="DEBUG" sid="686712581298676" static="0" type="text"></variable>
        <variable constant="0" name="M7_Temperature" sid="176103752440200" static="0" type="number">18</variable>
        <event-group description="" sid="385953040015592" title="M7 Room Object Data Initialization">
            <sub-events>
                <event-block sid="706266292160068">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="396147156109733" type="System" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-group description="" sid="129594061920019" title="M7 Initialize Rooms">
                            <sub-events>
                                <event-block sid="109879392692079">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="541853562907766" type="M7_Room0">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room1.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="469159908748656" type="M7_Room1">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room0.UID &amp; &quot; &quot; &amp; M7_Room2.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="573632347929723" type="M7_Room2">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room1.UID &amp; &quot; &quot; &amp; M7_Room5.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="921485946918487" type="M7_Room3">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room4.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="475336989790265" type="M7_Room4">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room3.UID &amp; &quot; &quot; &amp; M7_Room5.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="898798206290336" type="M7_Room5">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room2.UID &amp; &quot; &quot; &amp; M7_Room4.UID &amp; &quot; &quot; &amp; M7_Room6.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="438743310599625" type="M7_Room6">
                                            <param id="0" name="Instance variable">Neighbours</param>
                                            <param id="1" name="Value">str(M7_Room5.UID)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="666374984055682" title="M7 Initialize Doors">
                            <sub-events>
                                <event-block sid="567468262794882">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="228985816112881" type="M7_Room0">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">str(M7_Door0.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="222650314081184" type="M7_Door0">
                                            <param id="0" name="Instance variable">Rooms</param>
                                            <param id="1" name="Value">M7_Room0.UID &amp; &quot; &quot; &amp; M7_Room1.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="698211616411536" type="M7_Room1">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">M7_Door0.UID &amp; &quot; &quot; &amp; M7_Door1.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="361589540805638" type="M7_Door1">
                                            <param id="0" name="Instance variable">Rooms</param>
                                            <param id="1" name="Value">M7_Room1.UID &amp; &quot; &quot; &amp; M7_Room2.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="874842496518485" type="M7_Room2">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">str(M7_Door1.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="724009584791557" type="M7_Room3">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">str(M7_Door2.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="164216785789491" type="M7_Door2">
                                            <param id="0" name="Instance variable">Rooms</param>
                                            <param id="1" name="Value">M7_Room3.UID &amp; &quot; &quot; &amp; M7_Room4.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="548537533528566" type="M7_Room4">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">M7_Door2.UID &amp; &quot; &quot; &amp; M7_Door3.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="508158832314142" type="M7_Door3">
                                            <param id="0" name="Instance variable">Rooms</param>
                                            <param id="1" name="Value">M7_Room4.UID &amp; &quot; &quot; &amp; M7_Room5.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="747041293790138" type="M7_Room5">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">M7_Door3.UID &amp; &quot; &quot; &amp; M7_Door4.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="939307343792438" type="M7_Door4">
                                            <param id="0" name="Instance variable">Rooms</param>
                                            <param id="1" name="Value">M7_Room5.UID &amp; &quot; &quot; &amp; M7_Room6.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="783882446361003" type="M7_Room6">
                                            <param id="0" name="Instance variable">Doors</param>
                                            <param id="1" name="Value">str(M7_Door4.UID)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="433448421815874" title="M7 Initialize Windows">
                            <sub-events>
                                <event-block sid="829930333150586">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="362018845322751" type="M7_Room0">
                                            <param id="0" name="Instance variable">Windows</param>
                                            <param id="1" name="Value">str(M7_Window0.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="707417144982359" type="M7_Room3">
                                            <param id="0" name="Instance variable">Windows</param>
                                            <param id="1" name="Value">str(M7_Window1.UID)</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="706890466919475" type="M7_Room6">
                                            <param id="0" name="Instance variable">Windows</param>
                                            <param id="1" name="Value">str(M7_Window2.UID)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="700672218353482" title="M7 Person Spawning">
                            <sub-events>
                                <variable constant="0" name="tempval" sid="485382954874502" static="0" type="number">0</variable>
                                <event-block sid="695204180281465">
                                    <conditions>
                                        <condition id="-11" name="For Each" sid="803406688183622" type="System">
                                            <param id="0" name="Object">M7_Person</param>
                                        </condition>
                                        <condition id="-16" name="Pick random instance" sid="925867933681916" type="System">
                                            <param id="0" name="Object">M7_Room</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="170204680818069" type="M7_Person">
                                            <param id="0" name="Instance variable">ChosenRoom</param>
                                            <param id="1" name="Value">M7_Room.UID</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="300700905452528" type="M7_Person">
                                            <param id="0" name="Instance variable">PreviousRoom</param>
                                            <param id="1" name="Value">M7_Person.ChosenRoom</param>
                                        </action>
                                        <action id="-3" name="Set position" sid="377029277269619" type="M7_Person">
                                            <param id="0" name="X">M7_Room.X</param>
                                            <param id="1" name="Y">M7_Room.Y</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="221648568052963" title="M7 Temperature Management">
            <sub-events>
                <event-group description="" sid="259876896402846" title="M7 Room Temperature Initialization">
                    <sub-events>
                        <event-block sid="748490071379055">
                            <conditions>
                                <condition id="-2" name="On start of layout" sid="660164024395221" type="System" />
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="101506629238562" type="System">
                                    <param id="0" name="Variable">M7_NUMBEROFROOMS</param>
                                    <param id="1" name="Value">M7_Room.Count</param>
                                </action>
                                <action id="-10" name="Set value" sid="376034596985204" type="M7_Room">
                                    <param id="0" name="Instance variable">Temperature</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="-10" name="Set value" sid="647266587729890" type="M7_Room">
                                    <param id="0" name="Instance variable">OldTemperature</param>
                                    <param id="1" name="Value">Self.Temperature</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-group>
                <comment>Update temperature value for each room</comment>
                <event-block sid="867267423801745">
                    <conditions>
                        <condition id="-11" name="For Each" sid="672540065038522" type="System">
                            <param id="0" name="Object">M7_Room</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-group description="" sid="911608263032701" title="M7 Change By Vent">
                            <sub-events>
                                <variable constant="1" name="M7_VENT_TEMP_CHANGE_PER_SECOND" sid="512645319629668" static="0" type="number">0.2</variable>
                                <event-block sid="941893856809144">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="418942861382075" type="M7_Room">
                                            <param id="0" name="Instance variable">Temperature</param>
                                            <param id="1" name="Value">Self.Temperature + M7_VENT_TEMP_CHANGE_PER_SECOND * Self.VentCount * dt</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="551481265412711" title="M7 Change by Window">
                            <sub-events>
                                <variable constant="1" name="M7_WINDOW_OPEN_CHANGE_PER_SECOND" sid="514014624442509" static="0" type="number">-0.4</variable>
                                <variable constant="1" name="M7_WINDOW_CLOSED_CHANGE_PER_SECOND" sid="846584333438592" static="0" type="number">-0.15</variable>
                                <event-block sid="265577437313055">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="786800773207660" type="M7_Room">
                                            <param id="0" name="Instance variable">Windows</param>
                                            <param id="1" name="Comparison">1</param>
                                            <param id="2" name="Value">&quot;&quot;</param>
                                        </condition>
                                        <condition id="-10" name="For" sid="640469078687657" type="System">
                                            <param id="0" name="Name">&quot;Every Window of Room&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">tokencount(M7_Room.Windows,&quot; &quot;)</param>
                                        </condition>
                                        <condition id="-14" name="Pick by unique ID" sid="571582659804088" type="M7_Window">
                                            <param id="0" name="Unique ID">int(tokenat(M7_Room.Windows, loopindex(&quot;Every Window of Room&quot;), &quot; &quot;))</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="640415768753072" type="M7_Room">
                                            <param id="0" name="Instance variable">Temperature</param>
                                            <param id="1" name="Value">Self.Temperature + (M7_Window.Closed = 1 ? M7_WINDOW_CLOSED_CHANGE_PER_SECOND : M7_WINDOW_OPEN_CHANGE_PER_SECOND) * dt</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="403950509424355" title="M7 Change By Neighbours">
                            <sub-events>
                                <variable constant="0" name="M7_NeighbourSum" sid="820022131288541" static="0" type="text"></variable>
                                <event-block sid="488012529377860">
                                    <conditions>
                                        <condition id="-10" name="For" sid="429304673790443" type="System">
                                            <param id="0" name="Name">&quot;Every Neighbour&quot;</param>
                                            <param id="1" name="Start index">0</param>
                                            <param id="2" name="End index">tokencount(M7_Room.Doors, &quot; &quot;) - 1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Add to" sid="931005645175163" type="System">
                                            <param id="0" name="Variable">M7_NeighbourSum</param>
                                            <param id="1" name="Value">int(tokenat(M7_Room.Neighbours, loopindex(&quot;Every Neighbour&quot;), &quot; &quot;)) - M7_Room.Temperature</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="196475243615891" title="M7 Change By Ambience">
                            <sub-events>
                                <variable constant="1" name="M7_AMBIENT_CHANGE_PER_SECOND" sid="846190021904372" static="0" type="number">-0.15</variable>
                                <event-block sid="985935294887746">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="621368304720562" type="M7_Room">
                                            <param id="0" name="Instance variable">Temperature</param>
                                            <param id="1" name="Value">Self.Temperature + M7_AMBIENT_CHANGE_PER_SECOND * dt</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <event-group description="" sid="710938550841922" title="M7 Update Room">
                            <sub-events>
                                <variable constant="1" name="M7_OPACITYMAX" sid="445236862712544" static="0" type="number">30</variable>
                                <event-block sid="762001667074124">
                                    <conditions />
                                    <actions>
                                        <action id="-10" name="Set value" sid="122534558232634" type="M7_Room">
                                            <param id="0" name="Instance variable">OldTemperature</param>
                                            <param id="1" name="Value">Self.Temperature</param>
                                        </action>
                                        <action id="-16" name="Set opacity" sid="748005148545468" type="M7_Room">
                                            <param id="0" name="Opacity">min(Self.Temperature * -1 * M7_OPACITYMAX, M7_OPACITYMAX)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-group>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="477988417948673" title="M7 Person Behaviour">
            <sub-events>
                <event-group description="" sid="444692670807075" title="M7 Person Movement">
                    <sub-events>
                        <event-block sid="992596853623321">
                            <conditions>
                                <condition id="-11" name="For Each" sid="138587533823919" type="System">
                                    <param id="0" name="Object">M7_Person</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="336021872179128">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="120223814381876" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;waiting&quot;</param>
                                        </condition>
                                        <condition id="-14" name="Pick by unique ID" sid="191094425248106" type="M7_Person">
                                            <param id="0" name="Unique ID">M7_Person.UID</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="590649684976288">
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" sid="811467062452882" type="M7_Person">
                                                    <param id="0" name="Instance variable">WaitingTimer</param>
                                                    <param id="1" name="Comparison">4</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="397469028218230" type="M7_Person">
                                                    <param id="0" name="Instance variable">WaitingTimer</param>
                                                    <param id="1" name="Value">M7_Person.WaitingTimer - dt</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <comment>Determine Next Action</comment>
                                        <event-block sid="374070843056974">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="392516550210689" type="System" />
                                            </conditions>
                                            <actions>
                                                <action id="0" name="Call function" sid="181801980070952" type="Function">
                                                    <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                                    <param id="1" name="Parameter {n}">M7_Person.UID</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <event-block sid="208338797312512">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="860086032869105" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;moving&quot;</param>
                                        </condition>
                                        <condition id="-14" name="Pick by unique ID" sid="187701257730905" type="M7_Person">
                                            <param id="0" name="Unique ID">M7_Person.UID</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <comment>Reached Destination</comment>
                                        <event-block sid="998483929997504">
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" sid="844706217003891" type="M7_Room">
                                                    <param id="0" name="Unique ID">M7_Person.ChosenRoom</param>
                                                </condition>
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block sid="214189201587763">
                                                    <conditions>
                                                        <condition id="-39" name="Is within angle" sid="245723705499204" type="System">
                                                            <param id="0" name="Angle 1">angle(M7_Person.X, M7_Person.Y, M7_Room.X, M7_Room.Y)</param>
                                                            <param id="1" name="Within">45</param>
                                                            <param id="2" name="Angle 2">M7_Person.MovementAngle</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions />
                                                </event-block>
                                                <event-block sid="533210332336858">
                                                    <conditions>
                                                        <condition id="-22" name="Else" sid="573481691074008" type="System" />
                                                    </conditions>
                                                    <actions>
                                                        <action id="-3" name="Set position" sid="444626252001873" type="M7_Person">
                                                            <param id="0" name="X">M7_Room.X</param>
                                                            <param id="1" name="Y">M7_Room.Y</param>
                                                        </action>
                                                        <action id="0" name="Call function" sid="561289083490309" type="Function">
                                                            <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                                            <param id="1" name="Parameter {n}">M7_Person.UID</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>Randomly Determine Next Action</comment>
                        <event-block sid="186799551660957">
                            <conditions>
                                <condition id="0" name="On function" sid="862728617815642" type="Function">
                                    <param id="0" name="Name">&quot;M7 Person Select Next State&quot;</param>
                                </condition>
                                <condition id="-14" name="Pick by unique ID" sid="226069610137845" type="M7_Person">
                                    <param id="0" name="Unique ID">Function.Param(0)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <variable constant="1" name="M7_WAITTIMEMIN" sid="613549810525179" static="0" type="number">1</variable>
                                <variable constant="1" name="M7_WAITTIMEMAX" sid="426087903147023" static="0" type="number">5</variable>
                                <variable constant="0" name="M7_PathfindingResult" sid="159745861010634" static="0" type="number">0</variable>
                                <comment>Choose State &quot;wait&quot;</comment>
                                <event-block sid="883936257607422">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="578717455060691" type="System">
                                            <param id="0" name="First value">choose(0,1)</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="271121073450955" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Value">&quot;waiting&quot;</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="480034802995934" type="M7_Person">
                                            <param id="0" name="Instance variable">WaitingTimer</param>
                                            <param id="1" name="Value">floor(random(M7_WAITTIMEMIN, M7_WAITTIMEMAX))</param>
                                        </action>
                                        <action behavior="CustomMovement" id="2" name="Set speed" sid="517012467587597" type="M7_Person">
                                            <param id="0" name="Which">0</param>
                                            <param id="1" name="Speed">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>Choose State &quot;moving&quot;</comment>
                                <event-block sid="763834153155574">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="508506810105473" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" sid="290334859214283" type="M7_Person">
                                            <param id="0" name="Instance variable">State</param>
                                            <param id="1" name="Value">&quot;moving&quot;</param>
                                        </action>
                                        <action id="0" name="Call function" sid="890305022044891" type="Function">
                                            <param id="0" name="Name">&quot;M7 Generate Path&quot;</param>
                                            <param id="1" name="Parameter {n}">M7_Person.ChosenRoom{###}M7_Person.PreviousRoom</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="338739071057528" type="System">
                                            <param id="0" name="Variable">M7_PathfindingResult</param>
                                            <param id="1" name="Value">Function.ReturnValue</param>
                                        </action>
                                        <action id="-10" name="Set value" sid="816077364387251" type="M7_Person">
                                            <param id="0" name="Instance variable">PreviousRoom</param>
                                            <param id="1" name="Value">M7_Person.ChosenRoom</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="370011847741207" type="System">
                                            <param id="0" name="Variable">DEBUG</param>
                                            <param id="1" name="Value">DEBUG &amp; M7_Person.UID &amp; &quot;: &quot;</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <comment>If Dead End</comment>
                                        <event-block sid="442489189099247">
                                            <conditions>
                                                <condition id="-14" name="Compare variable" sid="501842653188751" type="System">
                                                    <param id="0" name="Variable">M7_PathfindingResult</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">-1</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="150865044490297" type="M7_Person">
                                                    <param id="0" name="Instance variable">State</param>
                                                    <param id="1" name="Value">&quot;waiting&quot;</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="680944514495134" type="M7_Person">
                                                    <param id="0" name="Instance variable">WaitingTimer</param>
                                                    <param id="1" name="Value">floor(random(M7_WAITTIMEMIN, M7_WAITTIMEMAX))</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="189113331255401" type="M7_Person">
                                                    <param id="0" name="Which">0</param>
                                                    <param id="1" name="Speed">0</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <comment>If not dead end, set path to new room</comment>
                                        <event-block sid="564717244208916">
                                            <conditions>
                                                <condition id="-22" name="Else" sid="940057136256202" type="System" />
                                                <condition id="-14" name="Pick by unique ID" sid="886678181754419" type="M7_Room">
                                                    <param id="0" name="Unique ID">M7_PathfindingResult</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="819282974575447" type="M7_Person">
                                                    <param id="0" name="Instance variable">ChosenRoom</param>
                                                    <param id="1" name="Value">M7_PathfindingResult</param>
                                                </action>
                                                <action id="-10" name="Set value" sid="574174858528248" type="M7_Person">
                                                    <param id="0" name="Instance variable">MovementAngle</param>
                                                    <param id="1" name="Value">angle(M7_Person.X, M7_Person.Y, M7_Room.X, M7_Room.Y)</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="462105046730464" type="M7_Person">
                                                    <param id="0" name="Which">1</param>
                                                    <param id="1" name="Speed">M7_Person.Speed * cos(M7_Person.MovementAngle)</param>
                                                </action>
                                                <action behavior="CustomMovement" id="2" name="Set speed" sid="163768502310696" type="M7_Person">
                                                    <param id="0" name="Which">2</param>
                                                    <param id="1" name="Speed">M7_Person.Speed * sin(M7_Person.MovementAngle)</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
                <event-group description="" sid="917615544399952" title="M7 Person Pathfinding">
                    <sub-events>
                        <variable constant="0" name="M7_PreviousRoom" sid="779199900776871" static="0" type="number">-1</variable>
                        <variable constant="0" name="M7_ChosenRoom" sid="270822681677396" static="0" type="number">-1</variable>
                        <variable constant="0" name="M7_TempIndex" sid="520575937611103" static="0" type="number">0</variable>
                        <variable constant="0" name="M7_Destination" sid="924721281698815" static="0" type="text"></variable>
                        <event-block sid="829543956718511">
                            <conditions>
                                <condition id="0" name="On function" sid="284524971819460" type="Function">
                                    <param id="0" name="Name">&quot;M7 Generate Path&quot;</param>
                                </condition>
                                <condition id="-14" name="Pick by unique ID" sid="989916811148078" type="M7_Room">
                                    <param id="0" name="Unique ID">Function.Param(0)</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="269290658189094" type="System">
                                    <param id="0" name="Variable">M7_ChosenRoom</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="499444474329027" type="System">
                                    <param id="0" name="Variable">M7_PreviousRoom</param>
                                    <param id="1" name="Value">Function.Param(1)</param>
                                </action>
                                <action id="-9" name="Set value" sid="935744398487189" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">M7_Room.Neighbours</param>
                                </action>
                                <action id="-9" name="Set value" sid="374021681513432" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">replace(M7_Destination, &quot; &quot; &amp; str(M7_PreviousRoom), &quot;&quot;)</param>
                                </action>
                                <action id="-9" name="Set value" sid="759081268066661" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">replace(M7_Destination, str(M7_PreviousRoom), &quot;&quot;)</param>
                                </action>
                                <action id="-9" name="Set value" sid="540530700623127" type="System">
                                    <param id="0" name="Variable">M7_Destination</param>
                                    <param id="1" name="Value">trim(M7_Destination)</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="230507823209844">
                                    <conditions>
                                        <condition id="-14" name="Compare variable" sid="369699700540553" type="System">
                                            <param id="0" name="Variable">M7_Destination</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set return value" sid="578413108229931" type="Function">
                                            <param id="0" name="Value">-1</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="666923171719823">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="254188515691240" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="546377288087668" type="System">
                                            <param id="0" name="Variable">M7_TempIndex</param>
                                            <param id="1" name="Value">tokencount(M7_Destination, &quot; &quot;)</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="641386603521397" type="System">
                                            <param id="0" name="Variable">M7_TempIndex</param>
                                            <param id="1" name="Value">floor(random(0, M7_TempIndex))</param>
                                        </action>
                                        <action id="-9" name="Set value" sid="895882997036051" type="System">
                                            <param id="0" name="Variable">M7_Destination</param>
                                            <param id="1" name="Value">tokenat(M7_Destination, M7_TempIndex, &quot; &quot;)</param>
                                        </action>
                                        <action id="1" name="Set return value" sid="701809167201610" type="Function">
                                            <param id="0" name="Value">int(M7_Destination)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
        <event-group description="" sid="615369672928270" title="M7 Object Behaviour">
            <sub-events>
                <event-group description="" sid="545667328686850" title="M7 Door Behaviour">
                    <sub-events>
                        <event-block sid="310730186494695">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="817041650241669" type="M7_Door">
                                    <param id="0" name="Instance variable">Open</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="773084409799769">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="297065913596970" type="M7_Door">
                                            <param id="0" name="Instance variable">Occupied</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block sid="847028597215671">
                                            <conditions>
                                                <condition id="17" name="On tap object" sid="948535004466842" type="Touch">
                                                    <param id="0" name="Object">M7_Door</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" sid="506243875820990" type="M7_Door">
                                                    <param id="0" name="Instance variable">Open</param>
                                                    <param id="1" name="Value">M7_Door.Open = 0 ? 1 : 0</param>
                                                </action>
                                                <action id="4" name="Set animation" sid="954334525393956" type="M7_Door">
                                                    <param id="0" name="Animation">M7_Door.Open = 0 ? &quot;Closed&quot; : &quot;Open&quot;</param>
                                                    <param id="1" name="From">1</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="407737920516727">
                            <conditions>
                                <condition id="-22" name="Else" sid="828346412450075" type="System" />
                            </conditions>
                            <actions />
                        </event-block>
                    </sub-events>
                </event-group>
            </sub-events>
        </event-group>
        <event-group description="" sid="662058481164618" title="M7 Scoring" />
        <event-group description="" sid="232970218801745" title="M7 Helper Functions">
            <sub-events>
                <comment>Get the room where the person is currently physically positioned</comment>
                <event-block sid="289670432378119">
                    <conditions>
                        <condition id="0" name="On function" sid="375982210602478" type="Function">
                            <param id="0" name="Name">&quot;M7 Get Room of Person&quot;</param>
                        </condition>
                        <condition id="-14" name="Pick by unique ID" sid="389041859218626" type="M7_Person">
                            <param id="0" name="Unique ID">Function.Param(0)</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="M7_TempRoom" sid="208235287455969" static="0" type="number">-1</variable>
                        <event-block sid="456263104223415">
                            <conditions>
                                <condition id="-11" name="For Each" sid="358103373036717" type="System">
                                    <param id="0" name="Object">M7_Room</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="548996644241661" type="System">
                                    <param id="0" name="Variable">M7_TempRoom</param>
                                    <param id="1" name="Value">-1</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block any="1" sid="365032048012580">
                                    <conditions />
                                    <actions />
                                    <sub-events>
                                        <event-block sid="762475245622578">
                                            <conditions>
                                                <condition id="-21" name="Is between values" sid="404104496847311" type="System">
                                                    <param id="0" name="Value">M7_Person.X + M7_Person.Width / 2</param>
                                                    <param id="1" name="Lower bound">M7_Room.X</param>
                                                    <param id="2" name="Upper bound">M7_Room.X + M7_Room.Width</param>
                                                </condition>
                                                <condition id="-21" name="Is between values" sid="800301294197650" type="System">
                                                    <param id="0" name="Value">M7_Person.Y + M7_Person.Height / 2</param>
                                                    <param id="1" name="Lower bound">M7_Room.Y</param>
                                                    <param id="2" name="Upper bound">M7_Room.Y + M7_Room.Height</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" sid="529811148339317" type="System">
                                                    <param id="0" name="Variable">M7_TempRoom</param>
                                                    <param id="1" name="Value">M7_Room.UID</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block sid="440707550319412">
                            <conditions />
                            <actions>
                                <action id="1" name="Set return value" sid="419930663737358" type="Function">
                                    <param id="0" name="Value">M7_TempRoom = -1 ? M7_Person.ChosenRoom : M7_TempRoom</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
